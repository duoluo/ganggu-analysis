# 港股打新收益分析系统

## 📋 系统简介

这是一个用于分析港股打新收益和分成的可视化系统，可以自动从Excel文件中提取数据，计算收益和分成，并通过网页进行直观展示。

## 🚀 快速开始

### 1. 生成数据

运行Python脚本生成分析数据：

```bash
python3 generate_report.py
```

这将读取 `2025收益计算.xlsx` 文件，计算所有收益和分成数据，并生成 `report_data.json` 文件。

### 2. 查看报告

在浏览器中打开 `report.html` 文件即可查看可视化报告。

**注意：** 由于浏览器安全限制，需要通过HTTP服务器访问，不能直接双击打开。

推荐使用Python自带的HTTP服务器：

```bash
# 在项目目录下运行
python3 -m http.server 8000

# 然后在浏览器访问
# http://localhost:8000/report.html
```

## 📊 功能说明

### 收益概览

- **统计卡片**：显示总收益、总分成、总亏损、股票数量、账户数量
- **股票收益饼图**：展示各股票收益占比（前10名）
- **股票收益柱状图**：展示股票收益排行（前15名）
- **账户收益表**：
  - 支持按分成比例筛选（30%/50%/35%）
  - 支持按总收益/总分成/亏损排序
  - 可导出Excel表格

### 分成详情

- **分成规则说明**：展示三个分成组的账户列表
- **账户分成汇总表**：
  - 显示每个账户的总收益、总分成、亏损金额
  - 支持按分成比例筛选
  - 可查看每个账户的详细分成明细
  - 可导出Excel表格
- **特定范围分成统计**：
  - 统计从长风药业到壁仞科技的分成
  - 郑爽爽、李芝灵(妗子)、王敏卓额外包含紫金国际
  - 可导出Excel表格

### 缺失信息

- 显示所有中签但未填写卖出价格的记录
- 包含账户名称、股票名称、具体位置

## 🔧 文件说明

```
GangGu/
├── 2025收益计算.xlsx          # 原始数据文件
├── generate_report.py         # 数据生成脚本
├── report_data.json           # 生成的JSON数据（自动生成）
├── report.html                # 可视化网页
├── report.js                  # 网页交互脚本
└── README.md                  # 本文档
```

## 📝 分成规则

### 30% 分成组
刘彬、芦云、郜燕燕、姚智鑫、李焱、叶通、赵苗苗、芦川、杨凯

### 50% 分成组
李文博、李妍妍、郑爽爽、刘增运(姐夫)、张连梅(妈妈)、李明华(大姐)、李维峰(李爸爸)

### 35% 分成组
其他所有账户（共33个）

### 计算规则
- **正收益**：按对应比例计算分成
- **负收益（亏损）**：不计算分成，单独统计亏损金额

## 🔄 更新数据

当Excel文件更新后，只需重新运行数据生成脚本：

```bash
python3 generate_report.py
```

然后刷新浏览器页面即可看到最新数据。

## 📥 导出功能

系统支持导出以下Excel表格：

1. **账户收益表** - 包含排名、账户名称、分成比例、总收益、总分成、亏损金额
2. **分成汇总表** - 包含账户名称、分成比例、总收益、总分成、亏损金额
3. **特定范围分成表** - 包含账户名称、分成比例、范围内收益、范围内分成、备注
4. **账户详细分成** - 包含每个股票的收益和分成明细

## 🎨 界面特点

- **响应式设计**：支持PC和移动端访问
- **交互式图表**：鼠标悬停显示详细数据
- **筛选功能**：按分成比例、排序方式筛选
- **颜色标识**：
  - 绿色：正收益/分成
  - 红色：负收益/亏损
  - 不同分成组有不同的标签颜色

## ⚠️ 注意事项

1. 确保 `2025收益计算.xlsx` 文件在正确的位置
2. 需要安装 `openpyxl` 库：`pip3 install openpyxl`
3. 网页需要通过HTTP服务器访问，不能直接打开HTML文件
4. 导出功能需要浏览器支持JavaScript

## 🐛 常见问题

**Q: 网页打开后显示"数据加载失败"？**

A: 确保已运行 `generate_report.py` 生成了 `report_data.json` 文件，并且通过HTTP服务器访问网页。

**Q: 如何修改分成比例？**

A: 编辑 `generate_report.py` 文件中的 `COMMISSION_RATES` 配置，然后重新运行脚本。

**Q: 导出的Excel文件在哪里？**

A: 导出的文件会自动下载到浏览器的默认下载目录。

## 📞 技术支持

如有问题，请检查：
1. Python版本是否为3.6+
2. 是否安装了所需的库
3. Excel文件格式是否正确
4. 浏览器控制台是否有错误信息

---

**版本：** 1.0
**更新日期：** 2026-01-22
